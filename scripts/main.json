{
  "name": "叙事主线",
  "description": "主线情节叙事",
  "debug": true,
  "creative": false,
  "lidar": true,
  "dependencies": [
    {
      "id": "red_monster",
      "path": "/scripts/src/enemies/red_monster.js"
    },
    {
      "id": "system_terminal",
      "path": "/scripts/src/layers/terminal.js"
    },
    {
      "id": "security_keypad",
      "path": "/scripts/src/layers/keypad.js"
    },
    {
      "id": "lyric_speaker",
      "path": "/scripts/src/layers/speaker.js"
    },
    {
      "id": "ending_speaker",
      "path": "/scripts/src/layers/ending.js"
    }
  ],
  "preload": [
    "/assets/models/facilities/main.glb",
    "/assets/models/facilities/numbers.glb",
    "/assets/models/facilities/1号场地的电脑.glb",
    "/assets/models/facilities/1号人.glb",
    "/assets/models/facilities/1号闸（上）.glb",
    "/assets/models/facilities/1号闸（下）.glb",
    "/assets/models/facilities/2号人.glb",
    "/assets/models/facilities/2号场地的电脑.glb",
    "/assets/models/facilities/2号闸（上）.glb",
    "/assets/models/facilities/2号闸（下）.glb",
    "/assets/models/facilities/3号场地的电脑.glb",
    "/assets/models/facilities/3号闸（上）.glb",
    "/assets/models/facilities/3号闸（下）.glb",
    "/assets/models/facilities/4号场地（渲染）.glb",
    "/assets/models/facilities/箭头.glb"
  ],
  "entities": [
    {
      "name": "主人公",
      "id": "self",
      "properties": {
        "coordinates": [0, 0, 0],
        "rotation": [0, 0, 0]
      }
    },
    {
      "name": "主设施",
      "id": "main_facility",
      "path": "/assets/models/facilities/main.glb",
      "properties": {
        "coordinates": [0, -2, 0],
        "lidar_color": "#007015",
        "intensity_drop": 1,
        "live_long": true,
        "rotation": [0, 0, 0]
      }
    },
    {
      "name": "密码箱",
      "id": "password_box",
      "path": "/assets/models/facilities/1号场地的电脑.glb",
      "properties": {
        "coordinates": [0, -2, 0],
        "lidar_color": "#ffeb95",
        "intensity_drop": 1,
        "rotation": [0, 0, 0],
        "access_callback": ["core.scene.player.teleport([-2,2,128])"]
      },
      "interact_callback": [
        "keypad.activate()",
        "console.log(global.keypad_usingTime)",
        "(!global.keypad_usingTime && speaker.speak('keypad_first'))",
        "(global.keypad_usingTime && speaker.speak('keypad_then'))",
        "global.keypad_usingTime=1"
      ]
    },
    {
      "name": "第一幕数字",
      "id": "password_number",
      "path": "/assets/models/facilities/numbers.glb",
      "properties": {
        "coordinates": [0, -2, 0],
        "lidar_color": "#ff9b2e",
        "intensity_drop": 2,
        "rotation": [0, 0, 0]
      },
      "interact_callback": []
    },
    {
      "name": "1号人",
      "id": "person_1",
      "path": "/assets/models/facilities/1号人.glb",
      "properties": {
        "coordinates": [0, -2, 0],
        "lidar_color": "#ffeb95",
        "intensity_drop": 1,
        "rotation": [0, 0, 0]
      },
      "interact_callback": []
    },
    {
      "name": "1号闸（上）",
      "id": "gate_1_up",
      "path": "/assets/models/facilities/1号闸（上）.glb",
      "properties": {
        "activated": false,
        "coordinates": [0, -2, 0],
        "lidar_color": "#ffeb95",
        "intensity_drop": 1,
        "rotation": [0, 0, 0]
      },
      "interact_callback": [
        "if(core.getEntity('gate_1_up').properties.activated){core.scene.remove('gate_1_up');core.getEntity('gate_1_up').properties.activated=false;core.getEntity('gate_1_down').properties.activated=true;core.scene.load('gate_1_down');}"
      ]
    },
    {
      "name": "1号闸（下）",
      "id": "gate_1_down",
      "path": "/assets/models/facilities/1号闸（下）.glb",
      "properties": {
        "activated": false,
        "coordinates": [0, -2, 0],
        "lidar_color": "#ffeb95",
        "intensity_drop": 1,
        "rotation": [0, 0, 0]
      },
      "interact_callback": [
        "if(core.getEntity('gate_1_down').properties.activated){core.scene.remove('gate_1_down');core.getEntity('gate_1_down').properties.activated=false;core.getEntity('gate_1_up').properties.activated=true;core.scene.load('gate_1_up');}"
      ]
    },
    {
      "name": "2号人",
      "id": "person_2",
      "path": "/assets/models/facilities/2号人.glb",
      "properties": {
        "coordinates": [0, -2, 0],
        "lidar_color": "#ffeb95",
        "intensity_drop": 1,
        "rotation": [0, 0, 0]
      },
      "interact_callback": []
    },
    {
      "name": "2号场地的电脑",
      "id": "computer_2",
      "path": "/assets/models/facilities/2号场地的电脑.glb",
      "properties": {
        "coordinates": [-30, 3, -93],
        "lidar_color": "#ffeb95",
        "intensity_drop": 1,
        "rotation": [0, 0, 0]
      },
      "interact_callback": ["ter2.activate()"]
    },
    {
      "name": "2号闸（上）",
      "id": "gate_2_up",
      "path": "/assets/models/facilities/2号闸（上）.glb",
      "properties": {
        "activated": false,
        "coordinates": [0, -2, 0],
        "lidar_color": "#ffeb95",
        "intensity_drop": 1,
        "rotation": [0, 0, 0]
      },
      "interact_callback": [
        "if(core.getEntity('gate_2_up').properties.activated){core.scene.remove('gate_2_up');core.getEntity('gate_2_up').properties.activated=false;core.getEntity('gate_2_down').properties.activated=true;core.scene.load('gate_2_down');}"
      ]
    },
    {
      "name": "2号闸（下）",
      "id": "gate_2_down",
      "path": "/assets/models/facilities/2号闸（下）.glb",
      "properties": {
        "activated": false,
        "coordinates": [0, -2, 0],
        "lidar_color": "#ffeb95",
        "intensity_drop": 1,
        "rotation": [0, 0, 0]
      },
      "interact_callback": [
        "if(core.getEntity('gate_2_down').properties.activated){core.scene.remove('gate_2_down');core.getEntity('gate_2_down').properties.activated=false;core.getEntity('gate_2_up').properties.activated=true;core.scene.load('gate_2_up');}"
      ]
    },
    {
      "name": "3号场地的电脑",
      "id": "computer_3",
      "path": "/assets/models/facilities/3号场地的电脑.glb",
      "properties": {
        "coordinates": [0, -2, 0],
        "lidar_color": "#ffeb95",
        "intensity_drop": 1,
        "rotation": [0, 0, 0]
      },
      "interact_callback": []
    },
    {
      "name": "3号闸（上）",
      "id": "gate_3_up",
      "path": "/assets/models/facilities/3号闸（上）.glb",
      "properties": {
        "activated": false,
        "coordinates": [0, -2, 0],
        "lidar_color": "#ffeb95",
        "intensity_drop": 1,
        "rotation": [0, 0, 0]
      },
      "interact_callback": [
        "(core.getEntity('gate_3_up').properties.activated) && core.scene.remove('gate_3_up') && (core.getEntity('gate_3_down').properties.activated=true || true) && core.scene.load('gate_3_down') && (core.getEntity('gate_3_up').properties.activated=false)"
      ]
    },
    {
      "name": "3号闸（下）",
      "id": "gate_3_down",
      "path": "/assets/models/facilities/3号闸（下）.glb",
      "properties": {
        "activated": false,
        "coordinates": [0, -2, 0],
        "lidar_color": "#ffeb95",
        "intensity_drop": 1,
        "rotation": [0, 0, 0]
      },
      "interact_callback": [
        "(core.getEntity('gate_3_down').properties.activated) && core.scene.remove('gate_3_down') && (core.getEntity('gate_3_up').properties.activated=true || true) && core.scene.load('gate_3_up') && (core.getEntity('gate_3_down').properties.activated=false)"
      ]
    },
    {
      "name": "4号场地（渲染）",
      "id": "field_4_render",
      "path": "/assets/models/facilities/4号场地（渲染）.glb",
      "properties": {
        "coordinates": [0, -2, 0],
        "lidar_color": "#ff9248",
        "intensity_drop": 1,
        "rotation": [0, 0, 0]
      }
    },
    {
      "name": "箭头",
      "id": "arrow",
      "path": "/assets/models/facilities/箭头.glb",
      "properties": {
        "coordinates": [0, -2, 0],
        "lidar_color": "#ff3846",
        "intensity_drop": 1,
        "rotation": [0, 0, 0]
      }
    }
  ],
  "speeches": [
    {
      "name": "初始台词",
      "id": "initial",
      "properties": {
        "type": "info",
        "description": "刚进入游戏说的话",
        "text": "这里？是哪里？",
        "duration": 3000,
        "coordinates": [0, 0, 0],
        "activated": false
      },
      "distance_callback": ["speaker.speak('initial')"]
    },
    {
      "name": "交互教学",
      "id": "keyhelp",
      "properties": {
        "type": "info",
        "description": "交互教学",
        "text": "按<span style='color: #ffff00; font-weight: bold;'>鼠标左键</span>发射点阵照亮前方",
        "duration": 3000,
        "coordinates": [8.18, -1.09, 0],
        "activated": false
      },
      "distance_callback": ["speaker.speak('keyhelp')"]
    },
    {
      "name": "第一次打开密码箱",
      "id": "keypad_first",
      "properties": {
        "type": "info",
        "description": "第一次打开密码箱时说的话",
        "text": "看起来我需要寻找密码。",
        "duration": 3000,
        "coordinates": [0, 0, 0],
        "activated": false
      },
      "distance_callback": ["speaker.speak('keypad_first')"]
    },
    {
      "name": "再次打开密码箱",
      "id": "keypad_then",
      "properties": {
        "type": "info",
        "description": "之后每次打开密码箱时说的话",
        "text": "密码是多少呢？",
        "duration": 1000,
        "coordinates": [0, 0, 0]
      },
      "distance_callback": ["speaker.speak('keypad_then')"]
    },
    {
      "name": "密码正确",
      "id": "keypad_success",
      "properties": {
        "type": "info",
        "description": "密码输入正确了，此时传送到未知位置",
        "text": "??眼前的场景似乎变化了！",
        "duration": 2000,
        "activated": false,
        "coordinates": [-2, 1.95, 128]
      },
      "distance_callback": ["speaker.speak('keypad_success')"]
    }
  ],
  "global": {
    "interact_distance": 3,
    "keypad_usingTime": 0,
    "level_bgm": "/assets/sounds/ingamesounds/level_bgm.mp3",
    "subtitles": [
      "在这个被遗忘的终端站...",
      "感谢你的游玩。"
    ],
    "credits" : {
      "title": "TERMINUS",
      "subtitle": "开发团队",
      "members": [
        {
          "role": "游戏总监",
          "name": "张三"
        },
        {
          "role": "程序开发",
          "name": "李四"
        },
        {
          "role": "美术设计",
          "name": "赵六"
        },
        {
          "role": "音乐音效",
          "name": "钱七"
        },
        {
          "role": "关卡设计",
          "name": "孙八"
        },
        {
          "role": "特别感谢",
          "name": "所有玩家"
        }
      ]
    }
  },
  "shortcut": {
    "KeyL": "core.scene.toggleLidar()",
    "KeyT": "ter.toggle()",
    "KeyK": "keypad.toggle()",
    "KeyD": "core.devtool.toggle()",
    "KeyC": "core.script.creative ^= 1",
    "KeyB": "core.scene.updateDebug();",
    "KeyV": "core.scene.clearDebug();",
    "KeyP": "core.scene.RayCaster.clearAllPoint();"
  },
  "scripts": [
    "window.global=core.script.global",
    "ending=new ending_speaker()",
    "speaker=new lyric_speaker()",
    "core.scene.load('main_facility')",
    "core.layers.push(core.scene)",
    "core.scene.spawn()",
    "core.scene.load('password_number')",
    "core.scene.load('password_box')",
    "core.getEntity('gate_1_up').properties.activated=true",
    "core.scene.load('gate_1_up')",
    "core.getEntity('gate_2_up').properties.activated=true",
    "core.scene.load('gate_2_up')",
    "core.getEntity('gate_3_up').properties.activated=true",
    "core.scene.load('gate_3_up')",
    "keypad=new security_keypad('password_box')",
    "keypad.setPassword('634')",
    "core.ter2=new system_terminal('computer_2')",
    "core.scene.load('computer_2')",
    "core.scene.player.teleport([-2,2,128])"
  ]
}
